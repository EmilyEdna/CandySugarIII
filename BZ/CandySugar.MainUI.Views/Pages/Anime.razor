@page "/Anime"
@inherits AnimeVM

<style>
    .Full {
        width:100%;
    }
</style>
<div>

    <MContainer @ref="Row" Class="Full">

        <div class="text-center" style="@Loading">
            <MProgressCircular Size="40" Indeterminate Color="red"></MProgressCircular>
        </div>

        <MList Style="@MCVisible">
            <MListItemGroup Color="primary">
                @foreach (var item in InitResult)
                {
                    <MListItem>
                        <MRow Style="margin-top:-10px;margin-left:-10px;margin-bottom:5px">
                            <MCol Cols="6">
                                <MImage Src="@item.Cover" @onclick="()=>DetailEvent(item)" AspectRatio=0.7 MaxHeight="350" MaxWidth="250">

                                </MImage>
                            </MCol>
                            <MCol Cols="6"></MCol>
                        </MRow>
                    </MListItem>
                }
            </MListItemGroup>
        </MList>

        @foreach (var item in InitResults)
        {
            <MRow NoGutters Style="@PCVisible">
                @foreach (var items in item)
                {
                    <MCol Cols="1.5">
                        <MImage Src="@items.Cover" @onclick="()=>DetailEvent(items)" AspectRatio=0.75
                                MaxHeight="350" MaxWidth="250"
                                LazySrc="https://picsum.photos/id/11/100/60"
                                Contain Dark>
                        <PlaceholderContent>
                            <MRow Class="fill-height ma-0"
                                  Align="@AlignTypes.Center"
                                  Justify="@JustifyTypes.Center">
                                 <MProgressCircular Indeterminate/>
                                </MRow>
                            </PlaceholderContent>
                        </MImage>
                        <ExpandTransition>
                            <MCard Show=@items.IsExtend Height=180 Width=200 class="mx-auto" Style="background-color:whitesmoke">
                                <span class="font-weight-medium text-sm-left text-truncate d-inline-block" style="max-width:190px">标题：@items.Title</span>
                                <span class="font-weight-medium text-sm-left text-truncate d-inline-block">年份：@items.Year</span>
                                <span class="font-weight-medium text-sm-left text-truncate d-inline-block">更新：@items.Update</span>
                                <MVirtualScroll Height=100 OverscanCount=0 ItemHeight=64 Items="DetailResult">
                                    <ItemContent>
                                        <MButton Class="blue lighten-3 d-flex justify-center" Style="margin:5px" OnClick="_=>PlayEvent(context.Play)"><span>@context.Collect</span></MButton>
                                        <MDivider/>
                                    </ItemContent>
                                </MVirtualScroll>
                            </MCard>
                        </ExpandTransition>
                    </MCol>
                }
            </MRow>
        }
        <MInfiniteScroll OnLoad="@OnLoad"
                         Parent="@Row.Ref">
        </MInfiniteScroll>
    </MContainer>
</div>